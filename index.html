<!doctype html>
<html lang="en">

<head>
    <title>Firma Digital COMO © </title>
    <link rel="icon" href="img/SSlogo.png" type="image/x-icon">

    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Bootstrap CSS v5.2.1 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="Css/Generador.css">
</head>

<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-generador mb-2">
        <div class="container-fluid">

            <a class="navbar-brand fw-bold">Generador Firma Digital</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link option-nav" href="./Generador_QR/index.html" target="_blank">Generador de
                            QR</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="mb-5">
        <div class="container-fluid p-4">
            <div class="row">
                <div class="col-md-3">
                    <form class="shadow-lg p-3 mb-5 bg-formulario rounded">
                        <h4>Ingrese Su Información</h4>
                        <hr>

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="nombre" name="nombre" placeholder="Nombre"
                                required oninput="generarInformacion()">
                            <label for="floatingInput">Nombre</label>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="apellido" name="apellido" placeholder="Apellido"
                                required oninput="generarInformacion()">
                            <label for="floatingInput">Apellido</label>
                        </div>
                        <div id="mensaje-correo" class="mb-2"></div>

                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="correo" name="correo" placeholder="Correo"
                                oninput="generarInformacion()" onclick="mostrarMensajeCorreo()" required>
                            <label for="correo">Correo</label>
                        </div>

                        <div class="form-floating mb-3">
                            <select class="form-select" id="sucursal" name="sucursal" required
                                oninput="generarInformacion()">
                                <option value="" disabled selected class="bg-primary text-white fw-bold">Selecciona una
                                    sucursal</option>
                                <option value="SanSalvador">San Salvador</option>
                                <option value="SantaAna">Santa Ana</option>
                                <option value="Soya">Soyapango</option>
                                <option value="Ahucha">Ahuachapán</option>
                                <option value="Sonso">Sonsonate</option>
                                <option value="LaLibertad">La Libertad</option>
                                <option value="Apopa">Apopa</option> <!-- ✅ NUEVA SUCURSAL -->
                            </select>
                            <label for="sucursal">Sucursal</label>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="number" class="form-control" id="telefono" name="telefono" maxlength="8"
                                placeholder="Teléfono" oninput="generarInformacion()">
                            <label for="telefono">Teléfono</label>
                        </div>

                        <div class="form-floating mb-3">
                            <input type="number" class="form-control" id="telefono-fijo" name="telefono-fijo"
                                maxlength="8" placeholder="Teléfono Fijo o PBX" oninput="generarInformacion()">
                            <label for="telefono">Teléfono Fijo o PBX</label>
                        </div>

                        <div class="form-floating mb-3">
                            <select class="form-select" id="area" name="area" required oninput="generarInformacion()">
                                <option value="" disabled selected class="bg-primary text-white fw-bold">Selecciona un
                                    área</option>
                                <option value="INFORMATICA">Informática</option>
                                <option value="RRHH">Recursos Humanos</option>
                                <option value="UNIDAD_CONTROL">Unidad de Control</option>
                                <option value="JEFE_UNIDAD_CONTROL">Jefe Unidad de Control</option>
                                <option value="BODEGA_CENTRAL">Bodega Central</option>
                                <option value="BODEGA">Bodega</option>
                                <option value="CONTABILIDAD">Contabilidad</option>
                                <option value="AUDITORIA_TERRITORIO">Auditoría de Territorio</option>
                                <option value="GERENCIA_GENERAL">Gerencia General</option>
                                <option value="JEFE_ADMINISTRATIVO">Jefe Administrativo</option>
                                <option value="ASISTENCIA_GERENCIA">Asistencia a la Gerencia</option>
                                <option value="GERENTE_ADMINISTRATIVO">Gerente Administrativo</option>
                                <option value="ENCARGADO_SUCURSAL">Encargado de Sucursal</option>
                                <option value="ENCARGADO_BODEGA">Encargado de Bodega</option>
                                <option value="TALLER">Taller</option>
                                <option value="SUPERVISOR_MIXTO">Supervisor Mixto</option>
                                <option value="SUPERVISOR_PROMOTOR">Supervisor Promotor</option>
                                <option value="SUPERVISOR_PANEL">Supervisor Panel</option>
                                <option value="SUPERVISOR_PANEL_PROMTORIA">Supervisor Panel y Promotores</option>
                                <option value="ASISTENTE_ADMINISTRATIVO">Asistente Administrativo</option>
                            </select>
                            <label for="area">Área</label>
                        </div>

                        <div class="d-grid mt-3">
                            <div id="loadingIndicator" class="d-none text-primary">Generando firma...</div>
                            <button onclick="generarImagenFirma()">Generar Firma</button>
                        </div>
                    </form>
                </div>

                <div class="col-md-9">
                    <h4 class="mb-3">VISTA PREVIA:</h4>
                    <hr>
                    <div class="container firma-generada">
                        <div class="container" id="firma-generada">
                            <img src="img/FIRMA2.0.png" alt="" class="correo-img correo-img-generada">
                            <div class="container-info-empleado ">
                                <h1 id="name" class="name">NOMBRE <b class="last-name">APELLIDO</b></h1>
                                <h5 id="text-information-area">Área | <b>Comercialización En Movimiento S.A de C.V </b></h5>
                                <ul class="pt-3">
                                    <li><i class="fas fa-envelope email-box p-2 m-2 "></i>
                                        <span id="text-information-email">CORREO</span>
                                    </li>
                                    <li><i class="fa-solid fa-location-pin email-box m-2 p-2"></i>
                                        <span id="text-information-sucursal">SUCURSAL</span>
                                    </li>
                                    <li><i class="fa-solid fa-phone email-box m-2 p-2 "></i>
                                        <span id="text-information-telefono">TELEFONO</span>
                                    </li>
                                    <li><i class="fa-solid fa-tty email-box m-2 p-2"></i>
                                        <span id="text-information-fijo">TELEFONO FIJO O PBX</span>
                                    </li>
                                </ul>
                            </div>
                            <div class="Qr_Ubicacion-Generada">
                                <img src="img/Ubicaciones_QR/QR_Ahuchapan.png" alt="" id="Qr_Ubicacion_img">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </main>

    <div class="container-fluid container-footer">
        <footer class="d-flex flex-wrap justify-content-between align-items-center py-4 border-top text-light">
            <p class="col-12 col-md-4 mb-0 text-light">Comercialización En Movimiento S.A de C.V - © 2024</p>
            <a class="text-light col-12 col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto link-dark text-decoration-none">
                <img src="img/SSlogo.png" class="logo-footer" style="max-width: 100px;"> </a>
            <ul class="nav col-12 col-md-4 justify-content-end">
                <li class="nav-item"><a class="nav-link px-2 text-light">Desarrollado por: <b>KLEM</b></a></li>
            </ul>
        </footer>
    </div>

    <!-- Bootstrap JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        crossorigin="anonymous"></script>

    <script src="GeneradorFirma.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://kit.fontawesome.com/9ec536fb8b.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>

    <script>
        function generarInformacion() {
            const nombre = document.getElementById('nombre').value.toUpperCase();
            const apellido = document.getElementById('apellido').value.toUpperCase();
            const correo = document.getElementById('correo').value + "@como.com.sv";
            const sucursal = document.getElementById('sucursal').options[document.getElementById('sucursal').selectedIndex].text;
            const telefono = document.getElementById('telefono').value;
            const telefonoFijo = document.getElementById('telefono-fijo').value;
            const area = document.getElementById('area').options[document.getElementById('area').selectedIndex].text;

            document.getElementById('name').innerHTML = `${nombre} <b class="last-name">${apellido}</b>`;
            document.getElementById('text-information-email').innerText = correo;
            document.getElementById('text-information-sucursal').innerText = `Sucursal: ${sucursal}`;
            document.getElementById('text-information-telefono').innerText = formatPhoneNumber(telefono);
            document.getElementById('text-information-fijo').innerText = formatPhoneNumber(telefonoFijo);
            document.getElementById('text-information-area').innerText = `${area} | Comercialización En Movimiento S.A de C.V `;

            const qrMap = {
                'Ahuachapán': 'QR_Ahuchapan.png',
                'San Salvador': 'QR_San_Salvador.png',
                'Santa Ana': 'QR_Santa_Ana.png',
                'Sonsonate': 'QR_Sonsonate.png',
                'La Libertad': 'QR_San_Salvador.png',
                'Soyapango': 'QR_Soyapango.png',
                'Apopa': 'QR_Apopa.png' // ✅ Nuevo QR
            };

            const qrUbicacion = document.getElementById('Qr_Ubicacion_img');
            if (sucursal in qrMap) {
                qrUbicacion.src = `img/Ubicaciones_QR/${qrMap[sucursal]}`;
            }
        }

        function formatPhoneNumber(phoneNumber) {
            const numericPhoneNumber = phoneNumber.replace(/\D/g, '');
            if (numericPhoneNumber.length >= 4) {
                return numericPhoneNumber.match(/.{1,4}/g).join('-');
            }
            return phoneNumber;
        }
    </script>
</body>
</html>
